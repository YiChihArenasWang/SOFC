bp700 = [0.05, 0.2327, 2.3, 2.3, 0.9882];
bp750 = [0.0367, 0.38, 2.8397, 2.8292, 0.9953];
bp800 = [0.0307,0.38,3.1323,3.1311,0.9918];

bp = [bp700, bp750, bp800];

value700 = [
0.01730959446092977, 1.091497975708502;
0.027695351137487636, 1.0785425101214574;
0.05192878338278932, 1.05748987854251;
0.06231454005934718, 1.0461538461538462;
0.0830860534124629, 1.0299595141700404;
0.10039564787339268, 1.0056680161943319;
0.04500494559841741, 1.0720647773279353;
0.09000989119683482, 1.0218623481781377;
0.11078140454995054, 0.994331983805668;
0.09000989119683482, 1.0218623481781377;
0.11770524233432245, 0.982995951417004;
0.1280909990108803, 0.97165991902834;
0.14193867457962414, 0.957085020242915;
0.152324431256182, 0.9441295546558705;
0.17309594460929772, 0.9295546558704453;
0.20079129574678536, 0.9198380566801619;
0.21463897131552917, 0.9101214574898785;
0.23194856577645895, 0.8987854251012145;
0.2561819980217606, 0.8874493927125505;
0.27695351137487634, 0.874493927125506;
0.29080118694362017, 0.8663967611336032;
0.2561819980217606, 0.8874493927125505;
0.1661721068249258, 0.9376518218623482;
0.1661721068249258, 0.9376518218623482;
0.29772502472799206, 0.8566801619433198;
0.31849653808110784, 0.8502024291497975;
0.3427299703264095, 0.8421052631578947;
0.37388724035608306, 0.8307692307692307;
0.37388724035608306, 0.8307692307692307;
0.39119683481701284, 0.8226720647773279;
0.41196834817012856, 0.8113360323886639;
0.4362017804154303, 0.8048582995951417;
0.456973293768546, 0.7967611336032389;
0.4812067260138477, 0.7902834008097166;
0.5262116716122651, 0.7692307692307692;
0.5400593471810089, 0.7595141700404858;
0.5642927794263106, 0.7514170040485829;
0.5919881305637982, 0.7417004048582996;
0.6196834817012858, 0.7319838056680161;
0.6369930761622157, 0.7255060728744939;
0.6681503461918892, 0.7174089068825911;
0.688921859545005, 0.6995951417004048;
0.7200791295746786, 0.6898785425101214;
0.76162215628091, 0.6785425101214575;
0.7927794263105836, 0.668825910931174;
0.8100890207715133, 0.6639676113360323;
0.841246290801187, 0.6558704453441295;
0.8758654797230465, 0.642914979757085;
0.9035608308605341, 0.6348178137651822;
0.9381800197823936, 0.6267206477732793;
0.9658753709198813, 0.617004048582996;
1.0004945598417407, 0.6072874493927125;
1.0143422354104847, 0.5959514170040485;
1.0524233432245302, 0.5846153846153845;
1.1078140454995054, 0.5651821862348178;
1.062809099901088, 0.5732793522267207;
1.138971315529179, 0.5587044534412955;
1.1632047477744807, 0.5441295546558704;
1.1909000989119682, 0.5327935222672064;
1.2220573689416419, 0.5263157894736842;
1.2497527200791296, 0.5182186234817814;
1.294757665677547, 0.5036437246963562;
1.2739861523244314, 0.5068825910931174;
1.3120672601384769, 0.4955465587044534;
1.3363006923837784, 0.48582995951417;
1.367457962413452, 0.47773279352226716;
1.3951533135509397, 0.46963562753036436;
1.4228486646884273, 0.45991902834008097;
1.4609297725024728, 0.4502024291497976;
1.4851632047477745, 0.44048582995951413;
1.5024727992087041, 0.43562753036437246;
1.5509396636993076, 0.42267206477732794;
1.5751730959446093, 0.41133603238866395;
1.6409495548961424, 0.38866396761133604;
1.6028684470820969, 0.39838056680161943;
1.6790306627101879, 0.3805668016194332;
1.6998021760633037, 0.36761133603238866;
1.7621167161226508, 0.34331983805668015;
1.7309594460929771, 0.3562753036437247;
1.8001978239366963, 0.33198380566801616;
1.8313550939663699, 0.32388663967611336;
1.8625123639960435, 0.31417004048582997;
1.8832838773491591, 0.29959514170040485;
1.9248269040553907, 0.28663967611336033;
1.9559841740850643, 0.27692307692307694;
1.987141444114738, 0.2688259109311741;
2.0079129574678536, 0.2574898785425101;
2.0425321463897133, 0.24453441295546557;
2.0771513353115725, 0.22186234817813763;
2.1013847675568744, 0.21214574898785424;
2.1221562809099903, 0.2040485829959514];

value750 = [
0.004497150873359735, 1.0736030828516376;
0.019379026951869004, 1.054243991481594;
0.02722188427207608, 1.0390731163168034;
0.04777408101699545, 1.0225636345198255;
0.06621891720773175, 1.0057195010648006;
0.08021005325818426, 0.9901227056079505;
0.10389070278457127, 0.9720109522360815;
0.12965698749860338, 0.9584930534428556;
0.15216446723194002, 0.9441334550248452;
0.1816892403570409, 0.9299462529155257;
0.21071433005176846, 0.9175235777304532;
0.23324353515164306, 0.9057093601054659;
0.2701114821665777, 0.8935402089037622;
0.29524773125100867, 0.8813000709867153;
0.3225782423557746, 0.8685123212655916;
0.3579688644461273, 0.8551668187810566;
0.39355501483532174, 0.8414461008011357;
0.432160991173294, 0.8320657134164892;
0.46231579992799593, 0.8213162965216508;
0.48836451440702167, 0.8093905283439813;
0.5222343608397165, 0.8009228272994624;
0.556343186304329, 0.7917655410201804;
0.5945581060446177, 0.7788966636243788;
0.6299270027684325, 0.7679951323395192;
0.6674032600464302, 0.7564750025352398;
0.7025983538379412, 0.7476929317513435;
0.7468529254757855, 0.7355947672649832;
0.7866103462402702, 0.7238211134773349;
0.8215881863664014, 0.7151810161241252;
0.8639526511154424, 0.7023222796876584;
0.9021892962222692, 0.6927593550349862;
0.9419901677198297, 0.6839671432917553;
0.9777935717744038, 0.6740695669810364;
1.0175509925388884, 0.6636243788662407;
1.052246402900026, 0.6545177973836325;
1.091938647564897, 0.6444072609268836;
1.127742051619471, 0.6363249163370854;
1.1602866506933496, 0.6255653584829124;
1.1921143126714753, 0.6170773755197241;
1.2213132052985065, 0.6061149984788561;
1.259701927971099, 0.5976168745563329;
1.2902043425904086, 0.5877294392049487;
1.3282020086653177, 0.5786532806003447;
1.3757588360169335, 0.5713923537166615;
1.406174349170091, 0.5609066017645269;
1.4469094114287844, 0.5491836527735523;
1.490816377202021, 0.5406855288510293;
1.5338760536802771, 0.5309299259709968;
1.5771747091904509, 0.5186695061352803;
1.6179097714491442, 0.5092992597099685;
1.6562984941217367, 0.4985802656931345;
1.6995536988988345, 0.4882770510090254;
1.7379858723045027, 0.4778420038535645;
1.783848121066157, 0.4689179596389818;
1.8286675522339886, 0.4628029611601257;
1.8621463420689999, 0.44997464760166306;
1.8969721046293653, 0.4393367812595071;
1.9347959677719706, 0.4252712706622046;
1.9839170215143203, 0.4142987526620018;
2.0168309518193444, 0.4082648818578237;
2.057022879914588, 0.39845857418111746;
2.0934128688656877, 0.38807423182233036;
2.137558813670842, 0.3791197647297434;
2.1810964482129336, 0.3658959537572254;
2.231933805911783, 0.35349356049082237;
2.277730878573823, 0.3426021701652976;
2.3139687899591563, 0.3348544772335463;
2.3456226490049783, 0.3209917858229388;
2.389703417710519, 0.3065003549335767;
2.411819840846172, 0.2960044620221073;
2.451598986977195, 0.28849001115505524;
2.494615212722375, 0.2757124023932664;
2.537587987734479, 0.26108913903255243;
2.5757811821082295, 0.2461920697698002;
2.620600613276061, 0.2351485650542541;
2.658055145187521, 0.22614339316499338;
2.689861081799109, 0.21143900212960143;
2.7286843118024606, 0.2038028597505324];


value800 = [
0.01730959446092977, 1.0510121457489878;
0.03115727002967359, 1.0396761133603238;
0.05192878338278932, 1.0251012145748988;
0.076162215628091, 1.0089068825910932;
0.10039564787339268, 0.9927125506072874;
0.13155291790306628, 0.9781376518218623;
0.152324431256182, 0.968421052631579;
0.16963402571711178, 0.957085020242915;
0.20079129574678536, 0.9489878542510121;
0.2215628090999011, 0.9360323886639675;
0.2423343224530168, 0.9246963562753036;
0.27002967359050445, 0.9165991902834008;
0.29772502472799206, 0.9036437246963562;
0.3219584569732938, 0.8955465587044534;
0.35311572700296734, 0.8842105263157894;
0.39119683481701284, 0.8761133603238866;
0.41543026706231456, 0.863157894736842;
0.43966369930761623, 0.8502024291497975;
0.47774480712166173, 0.8437246963562752;
0.5123639960435212, 0.837246963562753;
0.533135509396637, 0.8242914979757084;
0.5712166172106825, 0.8161943319838056;
0.5989119683481702, 0.8097165991902834;
0.6404549950544016, 0.7999999999999999;
0.6681503461918892, 0.7935222672064777;
0.6993076162215628, 0.7789473684210526;
0.7235410484668645, 0.7773279352226721;
0.7512363996043521, 0.7676113360323886;
0.7789317507418397, 0.7611336032388664;
0.8204747774480712, 0.7465587044534413;
0.8689416419386746, 0.7368421052631579;
0.8897131552917903, 0.7336032388663968;
0.917408506429278, 0.7255060728744939;
0.9485657764589516, 0.7174089068825911;
0.9693372898120672, 0.7125506072874493;
1.0247279920870425, 0.6995951417004048;
1.073194856577646, 0.6898785425101214;
0.993570722057369, 0.7044534412955465;
1.1112759643916914, 0.6834008097165991;
1.1355093966369931, 0.6769230769230768;
1.1701285855588526, 0.665587044534413;
1.225519287833828, 0.6574898785425101;
1.1978239366963404, 0.6591093117408907;
1.2497527200791296, 0.6510121457489878;
1.2739861523244314, 0.6445344129554655;
1.2982195845697329, 0.6380566801619433;
1.3224530168150346, 0.631578947368421;
1.36053412462908, 0.6251012145748988;
1.3916913946587537, 0.617004048582996;
1.4228486646884273, 0.6072874493927125;
1.447082096933729, 0.6024291497975708;
1.4713155291790307, 0.5975708502024292;
1.530168150346192, 0.5862348178137652;
1.5024727992087041, 0.5894736842105263;
1.5613254203758655, 0.5781376518218623;
1.5924826904055391, 0.5684210526315789;
1.6305637982195846, 0.5603238866396761;
1.6617210682492582, 0.5538461538461539;
1.6963402571711177, 0.545748987854251;
1.7274975272007913, 0.5408906882591092;
1.758654797230465, 0.5327935222672064;
1.8001978239366963, 0.5198380566801619;
1.827893175074184, 0.5133603238866397;
1.8659742828882295, 0.5036437246963562;
1.8971315529179031, 0.497165991902834;
1.9213649851632046, 0.49068825910931174;
1.9732937685459941, 0.47935222672064776;
2.0044510385756675, 0.47449392712550603;
2.032146389713155, 0.46801619433198377;
2.0667655786350148, 0.45668016194331984;
2.1013847675568744, 0.4469635627530364;
2.132542037586548, 0.44048582995951413;
2.1602373887240356, 0.43400809716599187;
2.191394658753709, 0.4291497975708502;
2.222551928783383, 0.42591093117408907;
2.260633036597428, 0.4145748987854251;
2.288328387734916, 0.4048582995951417;
2.3229475766567753, 0.39838056680161943;
2.364490603363007, 0.39190283400809717;
2.3921859545004946, 0.3838056680161943;
2.416419386745796, 0.37732793522267205;
2.4787339268051434, 0.36275303643724693;
2.4441147378832837, 0.36761133603238866;
2.509891196834817, 0.35465587044534413;
2.5479723046488627, 0.34331983805668015;
2.582591493570722, 0.33198380566801616;
2.6241345202769537, 0.3271255060728745;
2.644906033630069, 0.32226720647773277;
2.662215628090999, 0.3125506072874494;
2.6899109792284865, 0.302834008097166;
2.724530168150346, 0.2931174089068826;
2.745301681503462, 0.28663967611336033;
2.7799208704253213, 0.28016194331983807;
2.814540059347181, 0.27692307692307694;
2.8456973293768546, 0.2672064777327935;
2.8837784371909, 0.2591093117408907;
2.9218595450049456, 0.24939271255060727;
2.946092977250247, 0.2380566801619433;
2.9772502472799207, 0.22834008097165992;
2.9980217606330366, 0.21538461538461537;
3.022255192878338, 0.20728744939271254];





Best_pos = bp700;
value = value700;
Vt = value(:,2);
It = value (:,1);
num = numel(It);

V0 = 1.121;
Ri = Best_pos(1);
i0 = Best_pos(2);
ias = Best_pos(3);
ics = Best_pos(4);
R = 8.314;
T = 800 +273.15;
n = 1;
F = 96485;
p0_H2 = Best_pos(5);
p0_H20 = 1- p0_H2;
i = 0;
V = 0;


ntemp = 0;
Vtemp = 10000;
j=1;

while Vtemp > 0

i(j) = ntemp;    
V(j) = V0 - ntemp.*Ri - 2.*R.*T./n./F .* log(1./2 .* (ntemp./i0 + sqrt((ntemp./i0).^2 +4))) + R.*T./2./F .* log(1 - ntemp./ias)...
    - R.*T./2./F .* log(1 + p0_H2.*ntemp./p0_H20./ias) + R.*T./4./F .* log(1 - ntemp./ics);
Vtemp = V(j);
ntemp = ntemp + 0.01;
j = j +1;

end

plot(i,V)
hold on
plot(It,Vt, 'o')



Best_pos = bp750;
value = value750;
Vt = value(:,2);
It = value (:,1);
num = numel(It);

V0 = 1.121;
Ri = Best_pos(1);
i0 = Best_pos(2);
ias = Best_pos(3);
ics = Best_pos(4);
R = 8.314;
T = 800 +273.15;
n = 1;
F = 96485;
p0_H2 = Best_pos(5);
p0_H20 = 1- p0_H2;
i = 0;
V = 0;


ntemp = 0;
Vtemp = 10000;
j=1;

while Vtemp > 0

i(j) = ntemp;    
V(j) = V0 - ntemp.*Ri - 2.*R.*T./n./F .* log(1./2 .* (ntemp./i0 + sqrt((ntemp./i0).^2 +4))) + R.*T./2./F .* log(1 - ntemp./ias)...
    - R.*T./2./F .* log(1 + p0_H2.*ntemp./p0_H20./ias) + R.*T./4./F .* log(1 - ntemp./ics);
Vtemp = V(j);
ntemp = ntemp + 0.01;
j = j +1;

end

plot(i,V)
hold on
plot(It,Vt, 'o')


Best_pos = bp800;
value = value800;
Vt = value(:,2);
It = value (:,1);
num = numel(It);

V0 = 1.121;
Ri = Best_pos(1);
i0 = Best_pos(2);
ias = Best_pos(3);
ics = Best_pos(4);
R = 8.314;
T = 800 +273.15;
n = 1;
F = 96485;
p0_H2 = Best_pos(5);
p0_H20 = 1- p0_H2;
i = 0;
V = 0;


ntemp = 0;
Vtemp = 10000;
j=1;

while Vtemp > 0

i(j) = ntemp;    
V(j) = V0 - ntemp.*Ri - 2.*R.*T./n./F .* log(1./2 .* (ntemp./i0 + sqrt((ntemp./i0).^2 +4))) + R.*T./2./F .* log(1 - ntemp./ias)...
    - R.*T./2./F .* log(1 + p0_H2.*ntemp./p0_H20./ias) + R.*T./4./F .* log(1 - ntemp./ics);
Vtemp = V(j);
ntemp = ntemp + 0.01;
j = j +1;

end

plot(i,V)
hold on
plot(It,Vt, 'o')


legend("Algorithm (700C)", "Experimental Data (700C)","Algorithm (750C)", "Experimental Data (750C)","Algorithm (800C)", "Experimental Data (800C)");
xlim([0 ics]);
ylim([0 1.2]);
xlabel("Current Density (A/cm^2)");
ylabel("Potential (V)");



