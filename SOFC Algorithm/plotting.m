value = [
0.004497150873359735, 1.0736030828516376;
0.019379026951869004, 1.054243991481594;
0.02722188427207608, 1.0390731163168034;
0.04777408101699545, 1.0225636345198255;
0.06621891720773175, 1.0057195010648006;
0.08021005325818426, 0.9901227056079505;
0.10389070278457127, 0.9720109522360815;
0.12965698749860338, 0.9584930534428556;
0.15216446723194002, 0.9441334550248452;
0.1816892403570409, 0.9299462529155257;
0.21071433005176846, 0.9175235777304532;
0.23324353515164306, 0.9057093601054659;
0.2701114821665777, 0.8935402089037622;
0.29524773125100867, 0.8813000709867153;
0.3225782423557746, 0.8685123212655916;
0.3579688644461273, 0.8551668187810566;
0.39355501483532174, 0.8414461008011357;
0.432160991173294, 0.8320657134164892;
0.46231579992799593, 0.8213162965216508;
0.48836451440702167, 0.8093905283439813;
0.5222343608397165, 0.8009228272994624;
0.556343186304329, 0.7917655410201804;
0.5945581060446177, 0.7788966636243788;
0.6299270027684325, 0.7679951323395192;
0.6674032600464302, 0.7564750025352398;
0.7025983538379412, 0.7476929317513435;
0.7468529254757855, 0.7355947672649832;
0.7866103462402702, 0.7238211134773349;
0.8215881863664014, 0.7151810161241252;
0.8639526511154424, 0.7023222796876584;
0.9021892962222692, 0.6927593550349862;
0.9419901677198297, 0.6839671432917553;
0.9777935717744038, 0.6740695669810364;
1.0175509925388884, 0.6636243788662407;
1.052246402900026, 0.6545177973836325;
1.091938647564897, 0.6444072609268836;
1.127742051619471, 0.6363249163370854;
1.1602866506933496, 0.6255653584829124;
1.1921143126714753, 0.6170773755197241;
1.2213132052985065, 0.6061149984788561;
1.259701927971099, 0.5976168745563329;
1.2902043425904086, 0.5877294392049487;
1.3282020086653177, 0.5786532806003447;
1.3757588360169335, 0.5713923537166615;
1.406174349170091, 0.5609066017645269;
1.4469094114287844, 0.5491836527735523;
1.490816377202021, 0.5406855288510293;
1.5338760536802771, 0.5309299259709968;
1.5771747091904509, 0.5186695061352803;
1.6179097714491442, 0.5092992597099685;
1.6562984941217367, 0.4985802656931345;
1.6995536988988345, 0.4882770510090254;
1.7379858723045027, 0.4778420038535645;
1.783848121066157, 0.4689179596389818;
1.8286675522339886, 0.4628029611601257;
1.8621463420689999, 0.44997464760166306;
1.8969721046293653, 0.4393367812595071;
1.9347959677719706, 0.4252712706622046;
1.9839170215143203, 0.4142987526620018;
2.0168309518193444, 0.4082648818578237;
2.057022879914588, 0.39845857418111746;
2.0934128688656877, 0.38807423182233036;
2.137558813670842, 0.3791197647297434;
2.1810964482129336, 0.3658959537572254;
2.231933805911783, 0.35349356049082237;
2.277730878573823, 0.3426021701652976;
2.3139687899591563, 0.3348544772335463;
2.3456226490049783, 0.3209917858229388;
2.389703417710519, 0.3065003549335767;
2.411819840846172, 0.2960044620221073;
2.451598986977195, 0.28849001115505524;
2.494615212722375, 0.2757124023932664;
2.537587987734479, 0.26108913903255243;
2.5757811821082295, 0.2461920697698002;
2.620600613276061, 0.2351485650542541;
2.658055145187521, 0.22614339316499338;
2.689861081799109, 0.21143900212960143;
2.7286843118024606, 0.2038028597505324];

Vt = value(:,2);
It = value (:,1);
num = numel(It);

V0 = 1.121;
Ri = Best_pos(1);
i0 = Best_pos(2);
ias = Best_pos(3);
ics = Best_pos(4);
R = 8.314;
T = 800 +273.15;
n = 1;
F = 96485;
p0_H2 = Best_pos(5);
p0_H20 = 1- p0_H2;
i = 0;
V = 0;


ntemp = 0;
Vtemp = 10000;
j=1;

while Vtemp > 0

i(j) = ntemp;    
V(j) = V0 - ntemp.*Ri - 2.*R.*T./n./F .* log(1./2 .* (ntemp./i0 + sqrt((ntemp./i0).^2 +4))) + R.*T./2./F .* log(1 - ntemp./ias)...
    - R.*T./2./F .* log(1 + p0_H2.*ntemp./p0_H20./ias) + R.*T./4./F .* log(1 - ntemp./ics);
Vtemp = V(j);
ntemp = ntemp + 0.01;
j = j +1;

end

plot(i,V)
hold on
plot(It,Vt, 'o')


legend("Algorithm", "Experimental Data");
xlim([0 ics]);
ylim([0 1.2]);
xlabel("Current Density (A/cm^2)");
ylabel("Potential (V)");
